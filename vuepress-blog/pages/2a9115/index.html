<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>shell脚本 | vivid&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/vuepress-blog/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="/vuepress-blog/img/adsbygoogle.js"></script>
    <meta name="description" content="技术文章">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.8afc26ef.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.b4cdbde0.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/2.55043232.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/15.6453ad30.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/10.d1403eac.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.69bedf09.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.78e32771.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.6bb605ea.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.e0bf95c9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.13a06298.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.fe821bf8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.aa2e575e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.a0a83eaf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/20.1016f3e0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.ee0d6db8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/3.0bb74a22.js"><link rel="prefetch" href="/vuepress-blog/assets/js/4.7bcc31ce.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.9555c16a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.d4d6fc9c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.9adade53.js"><link rel="prefetch" href="/vuepress-blog/assets/js/8.69a84ddf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/9.51482335.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.8afc26ef.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><img src="/vuepress-blog/img/EB-logo.png" alt="vivid's blog" class="logo"> <span class="site-name can-hide">vivid's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><a href="/vuepress-blog/tutorials/" class="link-title">教程</a> <span class="title" style="display:none;">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/pages/767b60/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/pages/767b70/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/vuepress-blog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/pages/2a9113/" class="nav-link">mysql相关</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vuepress-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://gitee.com/vividcode/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Source
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><a href="/vuepress-blog/tutorials/" class="link-title">教程</a> <span class="title" style="display:none;">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/pages/767b60/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/pages/767b70/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/vuepress-blog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/pages/2a9113/" class="nav-link">mysql相关</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vuepress-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://gitee.com/vividcode/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Source
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>其他</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog/pages/767b70/" class="sidebar-link">idea使用教程</a></li><li><a href="/vuepress-blog/pages/2a9109/" class="sidebar-link">开源项目推荐</a></li><li><a href="/vuepress-blog/pages/2a9110/" class="sidebar-link">frp使用教程</a></li><li><a href="/vuepress-blog/pages/2a9111/" class="sidebar-link">padavan发送消息到微信</a></li><li><a href="/vuepress-blog/pages/2a9112/" class="sidebar-link">PicGo图床搭建</a></li><li><a href="/vuepress-blog/pages/2a9115/" aria-current="page" class="active sidebar-link">shell脚本</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#解释器" class="sidebar-link">解释器</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#注释" class="sidebar-link">注释</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#echo" class="sidebar-link">echo</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#命令替换" class="sidebar-link">命令替换</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#printf" class="sidebar-link">printf</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#变量" class="sidebar-link">变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#变量命名原则" class="sidebar-link">变量命名原则</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#声明变量" class="sidebar-link">声明变量</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#只读变量" class="sidebar-link">只读变量</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#删除变量" class="sidebar-link">删除变量</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#变量类型" class="sidebar-link">变量类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#字符串" class="sidebar-link">字符串</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#单引号和双引号" class="sidebar-link">单引号和双引号</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#拼接字符串" class="sidebar-link">拼接字符串</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#获取字符串长度" class="sidebar-link">获取字符串长度</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#截取子字符串" class="sidebar-link">截取子字符串</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#查找子字符串" class="sidebar-link">查找子字符串</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#数组" class="sidebar-link">数组</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#创建数组" class="sidebar-link">创建数组</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#访问数组元素" class="sidebar-link">访问数组元素</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#访问数组长度" class="sidebar-link">访问数组长度</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#向数组中添加元素" class="sidebar-link">向数组中添加元素</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#从数组中删除元素" class="sidebar-link">从数组中删除元素</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#运算符" class="sidebar-link">运算符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#运算" class="sidebar-link">运算</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#算术运算符" class="sidebar-link">算术运算符</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#关系运算符" class="sidebar-link">关系运算符</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#布尔运算符" class="sidebar-link">布尔运算符</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#逻辑运算符" class="sidebar-link">逻辑运算符</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#字符串运算符" class="sidebar-link">字符串运算符</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#文件测试运算符" class="sidebar-link">文件测试运算符</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#控制语句" class="sidebar-link">控制语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#条件语句" class="sidebar-link">条件语句</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#循环语句" class="sidebar-link">循环语句</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#函数" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#位置参数" class="sidebar-link">位置参数</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#函数处理参数" class="sidebar-link">函数处理参数</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#shell-扩展" class="sidebar-link">Shell 扩展</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#流和重定向" class="sidebar-link">流和重定向</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#输入、输出流" class="sidebar-link">输入、输出流</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#重定向" class="sidebar-link">重定向</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#dev-null-文件" class="sidebar-link">/dev/null 文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#debug" class="sidebar-link">Debug</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#使用curl调试接口" class="sidebar-link">使用curl调试接口</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#使用ssh管理主机" class="sidebar-link">使用ssh管理主机</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#登录远程主机" class="sidebar-link">登录远程主机</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#上传下载文件" class="sidebar-link">上传下载文件</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#sshfs挂载远程目录" class="sidebar-link">sshfs挂载远程目录</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#免密码登录" class="sidebar-link">免密码登录</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/pages/2a9115/#端口转发" class="sidebar-link">端口转发</a></li></ul></li></ul></li><li><a href="/vuepress-blog/pages/2a9116/" class="sidebar-link">ansible</a></li></ul></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/vuepress-blog/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/vuepress-blog/tutorials" title="教程-目录页" data-v-1cd794fe>教程</a></li> <li data-v-1cd794fe><a href="/vuepress-blog/tutorials/#其他" title="教程#其他" data-v-1cd794fe>其他</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>vivid</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2022-01-21</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          shell脚本
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h2 id="解释器"><a href="#解释器" class="header-anchor">#</a> 解释器</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 以下两种方式都可以指定 shell 解释器为 bash，第二种方式更好</span>
<span class="token comment">#!/bin/bash</span>
<span class="token comment">#!/usr/bin/env bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Hello, world!&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="注释"><a href="#注释" class="header-anchor">#</a> 注释</h2> <p>注释可以说明你的代码是什么作用，以及为什么这样写。</p> <p>shell 语法中，注释是特殊的语句，会被 shell 解释器忽略。</p> <ul><li>单行注释 - 以 <code>#</code> 开头，到行尾结束。</li> <li>多行注释 - 以 <code>:&lt; 开头，到</code>EOF` 结束。</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#--------------------------------------------</span>
<span class="token comment"># shell 注释示例</span>
<span class="token comment"># author：zp</span>
<span class="token comment">#--------------------------------------------</span>

<span class="token comment"># echo '这是单行注释'</span>

<span class="token comment">########## 这是分割线 ##########</span>

:<span class="token operator">&lt;&lt;</span><span class="token string">EOF
echo '这是多行注释'
echo '这是多行注释'
echo '这是多行注释'
EOF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="echo"><a href="#echo" class="header-anchor">#</a> echo</h2> <p>echo 用于字符串的输出。</p> <p>输出普通字符串：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;hello, world&quot;</span>
<span class="token comment"># Output: hello, world</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>输出含变量的字符串：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;hello, <span class="token entity" title="\&quot;">\&quot;</span>zp<span class="token entity" title="\&quot;">\&quot;</span>&quot;</span>
<span class="token comment"># Output: hello, &quot;zp&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>输出含变量的字符串：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">name</span><span class="token operator">=</span>zp
<span class="token builtin class-name">echo</span> <span class="token string">&quot;hello, <span class="token entity" title="\&quot;">\&quot;</span><span class="token variable">${name}</span><span class="token entity" title="\&quot;">\&quot;</span>&quot;</span>
<span class="token comment"># Output: hello, &quot;zp&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>输出含换行符的字符串：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 输出含换行符的字符串</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;YES<span class="token entity" title="\n">\n</span>NO&quot;</span>
<span class="token comment">#  Output: YES\nNO</span>

<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;YES<span class="token entity" title="\n">\n</span>NO&quot;</span> <span class="token comment"># -e 开启转义</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  YES</span>
<span class="token comment">#  NO</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>输出含不换行符的字符串：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;YES&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;NO&quot;</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  YES</span>
<span class="token comment">#  NO</span>

<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;YES<span class="token entity" title="\c">\c</span>&quot;</span> <span class="token comment"># -e 开启转义 \c 不换行</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;NO&quot;</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  YESNO</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>输出重定向至文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;test&quot;</span> <span class="token operator">&gt;</span> test.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输出执行结果</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
<span class="token comment">#  Output:(当前目录路径)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="命令替换"><a href="#命令替换" class="header-anchor">#</a> 命令替换</h3> <p>获取某一段命令的执行结果，它的方式有两种：</p> <ul><li><code>command</code></li> <li><code>$(command)</code></li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">all_files</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span> <span class="token comment"># 获取ls命令的执行结果</span>
<span class="token assign-left variable">all_files</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span> <span class="token comment"># 效果同上</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="printf"><a href="#printf" class="header-anchor">#</a> printf</h2> <p>printf 用于格式化输出字符串。</p> <p>默认，printf 不会像 echo 一样自动添加换行符，如果需要换行可以手动添加 <code>\n</code>。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 单引号</span>
<span class="token builtin class-name">printf</span> <span class="token string">'%d %s\n'</span> <span class="token number">1</span> <span class="token string">&quot;abc&quot;</span>
<span class="token comment">#  Output:1 abc</span>

<span class="token comment"># 双引号</span>
<span class="token builtin class-name">printf</span> <span class="token string">&quot;%d %s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token number">1</span> <span class="token string">&quot;abc&quot;</span>
<span class="token comment">#  Output:1 abc</span>

<span class="token comment"># 无引号</span>
<span class="token builtin class-name">printf</span> %s abcdef
<span class="token comment">#  Output: abcdef(并不会换行)</span>

<span class="token comment"># 格式只指定了一个参数，但多出的参数仍然会按照该格式输出</span>
<span class="token builtin class-name">printf</span> <span class="token string">&quot;%s<span class="token entity" title="\n">\n</span>&quot;</span> abc def
<span class="token comment">#  Output:</span>
<span class="token comment">#  abc</span>
<span class="token comment">#  def</span>

<span class="token builtin class-name">printf</span> <span class="token string">&quot;%s %s %s<span class="token entity" title="\n">\n</span>&quot;</span> a b c d e f g h i j
<span class="token comment">#  Output:</span>
<span class="token comment">#  a b c</span>
<span class="token comment">#  d e f</span>
<span class="token comment">#  g h i</span>
<span class="token comment">#  j</span>

<span class="token comment"># 如果没有参数，那么 %s 用 NULL 代替，%d 用 0 代替</span>
<span class="token builtin class-name">printf</span> <span class="token string">&quot;%s and %d <span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#   and 0</span>

<span class="token comment"># 格式化输出 %-10s：指一个宽度为 10 个字符</span>
<span class="token builtin class-name">printf</span> <span class="token string">&quot;%-10s %-8s %-4s<span class="token entity" title="\n">\n</span>&quot;</span> 姓名 性别 体重kg
<span class="token builtin class-name">printf</span> <span class="token string">&quot;%-10s %-8s %-4.2f<span class="token entity" title="\n">\n</span>&quot;</span> 郭靖 男 <span class="token number">66.1234</span>
<span class="token builtin class-name">printf</span> <span class="token string">&quot;%-10s %-8s %-4.2f<span class="token entity" title="\n">\n</span>&quot;</span> 杨过 男 <span class="token number">48.6543</span>
<span class="token builtin class-name">printf</span> <span class="token string">&quot;%-10s %-8s %-4.2f<span class="token entity" title="\n">\n</span>&quot;</span> 郭芙 女 <span class="token number">47.9876</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  姓名     性别   体重kg</span>
<span class="token comment">#  郭靖     男      66.12</span>
<span class="token comment">#  杨过     男      48.65</span>
<span class="token comment">#  郭芙     女      47.99</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h4 id="printf-的转义符"><a href="#printf-的转义符" class="header-anchor">#</a> printf 的转义符</h4> <table><thead><tr><th>序列</th> <th>说明</th></tr></thead> <tbody><tr><td><code>\a</code></td> <td>警告字符，通常为 ASCII 的 BEL 字符</td></tr> <tr><td><code>\b</code></td> <td>后退</td></tr> <tr><td><code>\c</code></td> <td>抑制（不显示）输出结果中任何结尾的换行字符（只在%b 格式指示符控制下的参数字符串中有效），而且，任何留在参数里的字符、任何接下来的参数以及任何留在格式字符串中的字符，都被忽略</td></tr> <tr><td><code>\f</code></td> <td>换页（formfeed）</td></tr> <tr><td><code>\n</code></td> <td>换行</td></tr> <tr><td><code>\r</code></td> <td>回车（Carriage return）</td></tr> <tr><td><code>\t</code></td> <td>水平制表符</td></tr> <tr><td><code>\v</code></td> <td>垂直制表符</td></tr> <tr><td><code>\\</code></td> <td>一个字面上的反斜杠字符</td></tr> <tr><td><code>\ddd</code></td> <td>表示 1 到 3 位数八进制值的字符。仅在格式字符串中有效</td></tr> <tr><td><code>\0ddd</code></td> <td>表示 1 到 3 位的八进制值字符</td></tr></tbody></table> <h2 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h2> <p>跟许多程序设计语言一样，你可以在 bash 中创建变量。</p> <p>Bash 中没有数据类型，bash 中的变量可以保存一个数字、一个字符、一个字符串等等。同时无需提前声明变量，给变量赋值会直接创建变量。</p> <h3 id="变量命名原则"><a href="#变量命名原则" class="header-anchor">#</a> 变量命名原则</h3> <ul><li>命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。</li> <li>中间不能有空格，可以使用下划线（_）。</li> <li>不能使用标点符号。</li> <li>不能使用 bash 里的关键字（可用 help 命令查看保留关键字）。</li></ul> <h3 id="声明变量"><a href="#声明变量" class="header-anchor">#</a> 声明变量</h3> <p>访问变量的语法形式为：<code>${var}</code> 和 <code>$var</code> 。</p> <p>变量名外面的花括号是可选的，加不加都行，加花括号是为了帮助解释器识别变量的边界，所以推荐加花括号。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">word</span><span class="token operator">=</span><span class="token string">&quot;hello&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${word}</span>
<span class="token comment"># Output: hello</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="只读变量"><a href="#只读变量" class="header-anchor">#</a> 只读变量</h3> <p>使用 readonly 命令可以将变量定义为只读变量，只读变量的值不能被改变。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">rword</span><span class="token operator">=</span><span class="token string">&quot;hello&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${rword}</span>
<span class="token builtin class-name">readonly</span> rword
<span class="token comment"># rword=&quot;bye&quot;  # 如果放开注释，执行时会报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="删除变量"><a href="#删除变量" class="header-anchor">#</a> 删除变量</h3> <p>使用 unset 命令可以删除变量。变量被删除后不能再次使用。unset 命令不能删除只读变量。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">dword</span><span class="token operator">=</span><span class="token string">&quot;hello&quot;</span>  <span class="token comment"># 声明变量</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${dword}</span>  <span class="token comment"># 输出变量值</span>
<span class="token comment"># Output: hello</span>

<span class="token builtin class-name">unset</span> dword    <span class="token comment"># 删除变量</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${dword}</span>
<span class="token comment"># Output: （空）</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="变量类型"><a href="#变量类型" class="header-anchor">#</a> 变量类型</h3> <ul><li><strong>局部变量</strong> - 局部变量是仅在某个脚本内部有效的变量。它们不能被其他的程序和脚本访问。</li> <li><strong>环境变量</strong> - 环境变量是对当前 shell 会话内所有的程序或脚本都可见的变量。创建它们跟创建局部变量类似，但使用的是 <code>export</code> 关键字，shell 脚本也可以定义环境变量。</li></ul> <p>常见的环境变量：</p> <table><thead><tr><th>变量</th> <th>描述</th></tr></thead> <tbody><tr><td><code>$HOME</code></td> <td>当前用户的用户目录</td></tr> <tr><td><code>$PATH</code></td> <td>用分号分隔的目录列表，shell 会到这些目录中查找命令</td></tr> <tr><td><code>$PWD</code></td> <td>当前工作目录</td></tr> <tr><td><code>$RANDOM</code></td> <td>0 到 32767 之间的整数</td></tr> <tr><td><code>$UID</code></td> <td>数值类型，当前用户的用户 ID</td></tr> <tr><td><code>$PS1</code></td> <td>主要系统输入提示符</td></tr> <tr><td><code>$PS2</code></td> <td>次要系统输入提示符</td></tr></tbody></table> <h2 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h2> <h3 id="单引号和双引号"><a href="#单引号和双引号" class="header-anchor">#</a> 单引号和双引号</h3> <p>shell 字符串可以用单引号 <code>''</code>，也可以用双引号 <code>“”</code>，也可以不用引号。</p> <ul><li>单引号的特点
<ul><li>单引号里不识别变量</li> <li>单引号里不能出现单独的单引号（使用转义符也不行），但可成对出现，作为字符串拼接使用。</li></ul></li> <li>双引号的特点
<ul><li>双引号里识别变量</li> <li>双引号里可以出现转义字符</li></ul></li></ul> <p>综上，推荐使用双引号。</p> <h3 id="拼接字符串"><a href="#拼接字符串" class="header-anchor">#</a> 拼接字符串</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 使用单引号拼接</span>
<span class="token assign-left variable">name1</span><span class="token operator">=</span><span class="token string">'white'</span>
<span class="token assign-left variable">str1</span><span class="token operator">=</span><span class="token string">'hello, '</span><span class="token variable">${name1}</span><span class="token string">''</span>
<span class="token assign-left variable">str2</span><span class="token operator">=</span><span class="token string">'hello, ${name1}'</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${str1}</span>_<span class="token variable">${str2}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># hello, white_hello, ${name1}</span>

<span class="token comment"># 使用双引号拼接</span>
<span class="token assign-left variable">name2</span><span class="token operator">=</span><span class="token string">&quot;black&quot;</span>
<span class="token assign-left variable">str3</span><span class="token operator">=</span><span class="token string">&quot;hello, &quot;</span><span class="token variable">${name2}</span><span class="token string">&quot;&quot;</span>
<span class="token assign-left variable">str4</span><span class="token operator">=</span><span class="token string">&quot;hello, <span class="token variable">${name2}</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${str3}</span>_<span class="token variable">${str4}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># hello, black_hello, black</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="获取字符串长度"><a href="#获取字符串长度" class="header-anchor">#</a> 获取字符串长度</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">text</span><span class="token operator">=</span><span class="token string">&quot;12345&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">#</span>text}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># 5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="截取子字符串"><a href="#截取子字符串" class="header-anchor">#</a> 截取子字符串</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">text</span><span class="token operator">=</span><span class="token string">&quot;12345&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${text<span class="token operator">:</span>2<span class="token operator">:</span>2}</span>
<span class="token comment"># Output: 从第 3 个字符开始，截取 2 个字符</span>
<span class="token comment"># 34</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="查找子字符串"><a href="#查找子字符串" class="header-anchor">#</a> 查找子字符串</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token shebang important">#!/usr/bin/env bash</span>

<span class="token assign-left variable">text</span><span class="token operator">=</span><span class="token string">&quot;hello&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> index <span class="token string">&quot;<span class="token variable">${text}</span>&quot;</span> ll<span class="token variable">`</span></span>

<span class="token comment"># Execute: ./str-demo5.sh</span>
<span class="token comment"># Output:</span>
<span class="token comment"># 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h2> <p>bash 只支持一维数组。</p> <p>数组下标从 0 开始，下标可以是整数或算术表达式，其值应大于或等于 0。</p> <h3 id="创建数组"><a href="#创建数组" class="header-anchor">#</a> 创建数组</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 创建数组的不同方式</span>
<span class="token assign-left variable">nums</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token assign-left variable">colors</span><span class="token operator">=</span><span class="token punctuation">(</span>red yellow <span class="token string">&quot;dark blue&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="访问数组元素"><a href="#访问数组元素" class="header-anchor">#</a> 访问数组元素</h3> <ul><li><strong>访问数组的单个元素：</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token variable">${nums<span class="token punctuation">[</span>1<span class="token punctuation">]</span>}</span>
<span class="token comment"># Output: 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><strong>访问数组的所有元素：</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token variable">${colors<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>
<span class="token comment"># Output: red yellow dark blue</span>

<span class="token builtin class-name">echo</span> <span class="token variable">${colors<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
<span class="token comment"># Output: red yellow dark blue</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面两行有很重要（也很微妙）的区别：</p> <p>为了将数组中每个元素单独一行输出，我们用 <code>printf</code> 命令：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">printf</span> <span class="token string">&quot;+ %s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token variable">${colors<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># + red</span>
<span class="token comment"># + yellow</span>
<span class="token comment"># + dark</span>
<span class="token comment"># + blue</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>为什么<code>dark</code>和<code>blue</code>各占了一行？尝试用引号包起来：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">printf</span> <span class="token string">&quot;+ %s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token string">&quot;<span class="token variable">${colors<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>&quot;</span>
<span class="token comment"># Output:</span>
<span class="token comment"># + red yellow dark blue</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>现在所有的元素都在一行输出 —— 这不是我们想要的！让我们试试<code>${colors[@]}</code></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">printf</span> <span class="token string">&quot;+ %s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token string">&quot;<span class="token variable">${colors<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>&quot;</span>
<span class="token comment"># Output:</span>
<span class="token comment"># + red</span>
<span class="token comment"># + yellow</span>
<span class="token comment"># + dark blue</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在引号内，<code>${colors[@]}</code>将数组中的每个元素扩展为一个单独的参数；数组元素中的空格得以保留。</p> <ul><li><strong>访问数组的部分元素：</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token variable">${nums<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>0<span class="token operator">:</span>2}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># 0 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在上面的例子中，<code>${array[@]}</code> 扩展为整个数组，<code>:0:2</code>取出了数组中从 0 开始，长度为 2 的元素。</p> <h3 id="访问数组长度"><a href="#访问数组长度" class="header-anchor">#</a> 访问数组长度</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">#</span>nums<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="向数组中添加元素"><a href="#向数组中添加元素" class="header-anchor">#</a> 向数组中添加元素</h3> <p>向数组中添加元素也非常简单：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">colors</span><span class="token operator">=</span><span class="token punctuation">(</span>white <span class="token string">&quot;<span class="token variable">${colors<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>&quot;</span> green black<span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${colors<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># white red yellow dark blue green black</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面的例子中，<code>${colors[@]}</code> 扩展为整个数组，并被置换到复合赋值语句中，接着，对数组<code>colors</code>的赋值覆盖了它原来的值。</p> <h3 id="从数组中删除元素"><a href="#从数组中删除元素" class="header-anchor">#</a> 从数组中删除元素</h3> <p>用<code>unset</code>命令来从数组中删除一个元素：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">unset</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${nums<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
<span class="token comment"># Output:</span>
<span class="token comment"># 1 2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="运算符"><a href="#运算符" class="header-anchor">#</a> 运算符</h2> <h3 id="运算"><a href="#运算" class="header-anchor">#</a> 运算</h3> <p><code>bash</code> 中的运算方式有以下几种：</p> <ul><li><code>$((...))</code></li> <li><code>expr</code></li> <li><code>let</code></li> <li><code>bc</code></li> <li><code>declare -i</code></li></ul> <h4 id=""><a href="#" class="header-anchor">#</a> $((...))</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token variable">))</span></span> <span class="token comment"># 加法</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">5</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token variable">))</span></span> <span class="token comment"># 除法</span>

<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>i<span class="token operator">++</span><span class="token variable">))</span></span> <span class="token comment"># 先返回值后运算</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token operator">++</span>i<span class="token variable">))</span></span> <span class="token comment"># 先运算后返回值</span>

<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token variable">))</span></span> <span class="token comment"># 圆括号改变运算顺序</span>

<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">0xff</span><span class="token variable">))</span></span> <span class="token comment"># 16进制转成10进制的运算</span>

<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">16</span><span class="token operator">&gt;&gt;</span><span class="token number">2</span><span class="token variable">))</span></span> <span class="token comment"># 位运算</span>

<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span><span class="token number">3</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token variable">))</span></span> <span class="token comment"># 逻辑运算，如果逻辑表达式为真，返回1，否则返回0</span>


<span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>a<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token variable">))</span></span> <span class="token comment"># 三元运算符</span>

<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>a<span class="token operator">=</span><span class="token number">1</span><span class="token variable">))</span></span> <span class="token comment"># 变量赋值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>[注意] 这个语法只能计算整数。</p> <h4 id="expr"><a href="#expr" class="header-anchor">#</a> expr</h4> <p>语法格式： <code>expr $num1 operator $num2</code></p> <p>操作符概览：</p> <ul><li><code>num1 | num2</code> -- <code>num1</code> 不为空且非0，返回 <code>num1</code> ; 否则返回 <code>num2</code></li> <li><code>num1 &amp; num2</code> -- <code>num1</code> 不为空且非0，返回 <code>num1</code> ；否则返回0</li> <li><code>num1 &lt; num2</code> -- <code>num1</code> 小于 <code>num2</code> ，返回1；否则返回0</li> <li><code>num1 &lt;= num2</code> -- <code>num1</code> 小于等于 num2 ，返回1；否则返回0</li> <li><code>num1 = num2</code> -- <code>num1</code> 等于 <code>num2</code> ，返回1；否则返回0</li> <li><code>num1 != num2</code> -- <code>num1</code> 不等于 <code>num2</code> ，返回1；否则返回0</li> <li><code>num1 &gt; num2</code> -- <code>num1</code> 大于 <code>num2</code> ，返回1；否则返回0</li> <li><code>num1 &gt;= num2</code> -- <code>num1</code>  大于等于 <code>num2</code> ，返回1；否则返回0</li> <li><code>num1 + num2</code> -- 求和</li> <li><code>num1 - num2</code> -- 求差</li> <li><code>num1 * num2</code> -- 求积</li> <li><code>num1 / num2</code> -- 求商</li> <li><code>num1 % num2</code> -- 求余</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">num1</span><span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">;</span> <span class="token assign-left variable">num2</span><span class="token operator">=</span><span class="token number">50</span>
<span class="token function">expr</span> <span class="token variable">$num1</span> <span class="token punctuation">\</span><span class="token operator">&gt;</span> <span class="token variable">$num2</span> <span class="token comment"># 大于不成立，返回0</span>
<span class="token function">expr</span> <span class="token variable">$num1</span> <span class="token punctuation">\</span><span class="token operator">&lt;</span> <span class="token variable">$num2</span> <span class="token comment"># 小于成立，返回1</span>
<span class="token function">expr</span> <span class="token variable">$num1</span> <span class="token punctuation">\</span><span class="token operator">|</span> <span class="token variable">$num2</span> <span class="token comment"># 返回 num1</span>
<span class="token function">expr</span> <span class="token variable">$num1</span> <span class="token punctuation">\</span><span class="token operator">&amp;</span> <span class="token variable">$num2</span> <span class="token comment"># 返回 num1</span>
<span class="token function">expr</span> <span class="token variable">$num1</span> + <span class="token variable">$num2</span> <span class="token comment"># 计算加法</span>
<span class="token assign-left variable">num3</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $num1 + $num2<span class="token variable">`</span></span> <span class="token comment"># 计算结果赋值给num3</span>
<span class="token function">expr</span> <span class="token variable">$num1</span> - <span class="token variable">$num2</span> <span class="token comment"># 计算减法</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>[注意] <code>&gt;</code>、<code>&lt;</code> 等操作符是 <code>Shell</code> 中的保留关键字，因此需要进行转义。否则就变成输出和输入重定向了。</p> <h4 id="let-命令"><a href="#let-命令" class="header-anchor">#</a> let 命令</h4> <p><code>let</code> 命令声明变量时，可以直接执行算术表达式。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">let</span> <span class="token string">&quot;foo = 1 + 2&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$foo</span> <span class="token comment"># 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="bc"><a href="#bc" class="header-anchor">#</a> bc</h4> <p>支持浮点数运算。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;scale=2;23/5&quot;</span> <span class="token operator">|</span> <span class="token function">bc</span> <span class="token comment"># scale表示浮点位数</span>
<span class="token assign-left variable">num1</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;scale=2;23/5&quot;</span> <span class="token operator">|</span> <span class="token function">bc</span><span class="token variable">`</span></span> <span class="token comment"># 运算结果保存为变量</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="declare-i-命令"><a href="#declare-i-命令" class="header-anchor">#</a> declare -i 命令</h4> <p><code>-i</code> 参数声明整数变量以后，可以直接进行数学运算。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">declare</span> -i <span class="token assign-left variable">val1</span><span class="token operator">=</span><span class="token number">12</span> <span class="token assign-left variable">val2</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token builtin class-name">declare</span> -i result
<span class="token assign-left variable">result</span><span class="token operator">=</span>val1*val2
<span class="token builtin class-name">echo</span> <span class="token variable">$result</span> <span class="token comment"># 60</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="算术运算符"><a href="#算术运算符" class="header-anchor">#</a> 算术运算符</h3> <p>下表列出了常用的算术运算符，假定变量 x 为 10，变量 y 为 20：</p> <table><thead><tr><th>运算符</th> <th>说明</th> <th>举例</th></tr></thead> <tbody><tr><td>+</td> <td>加法</td> <td><code>expr $x + $y</code> 结果为 30。</td></tr> <tr><td>-</td> <td>减法</td> <td><code>expr $x - $y</code> 结果为 -10。</td></tr> <tr><td>*</td> <td>乘法</td> <td><code>expr $x * $y</code> 结果为 200。</td></tr> <tr><td>/</td> <td>除法</td> <td><code>expr $y / $x</code> 结果为 2。</td></tr> <tr><td>%</td> <td>取余</td> <td><code>expr $y % $x</code> 结果为 0。</td></tr> <tr><td>=</td> <td>赋值</td> <td><code>x=$y</code> 将把变量 y 的值赋给 x。</td></tr> <tr><td>==</td> <td>相等。用于比较两个数字，相同则返回 true。</td> <td><code>[ $x == $y ]</code> 返回 false。</td></tr> <tr><td>!=</td> <td>不相等。用于比较两个数字，不相同则返回 true。</td> <td><code>[ $x != $y ]</code> 返回 true。</td></tr></tbody></table> <p>**注意：**条件表达式要放在方括号之间，并且要有空格，例如: <code>[$x==$y]</code> 是错误的，必须写成 <code>[ $x == $y ]</code>。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">20</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;x=<span class="token variable">${x}</span>, y=<span class="token variable">${y}</span>&quot;</span>

<span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> + $<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> + <span class="token variable">${y}</span> = <span class="token variable">$val</span>&quot;</span>

<span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> - $<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> - <span class="token variable">${y}</span> = <span class="token variable">$val</span>&quot;</span>

<span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> <span class="token punctuation">\</span>* $<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> * <span class="token variable">${y}</span> = <span class="token variable">$val</span>&quot;</span>

<span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>y<span class="token punctuation">}</span> / $<span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${y}</span> / <span class="token variable">${x}</span> = <span class="token variable">$val</span>&quot;</span>

<span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>y<span class="token punctuation">}</span> % $<span class="token punctuation">{</span>x<span class="token punctuation">}</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${y}</span> % <span class="token variable">${x}</span> = <span class="token variable">$val</span>&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token operator">==</span> <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> = <span class="token variable">${y}</span>&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token operator">!=</span> <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> != <span class="token variable">${y}</span>&quot;</span>
<span class="token keyword">fi</span>

<span class="token comment">#  Execute: ./operator-demo.sh</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  x=10, y=20</span>
<span class="token comment">#  10 + 20 = 30</span>
<span class="token comment">#  10 - 20 = -10</span>
<span class="token comment">#  10 * 20 = 200</span>
<span class="token comment">#  20 / 10 = 2</span>
<span class="token comment">#  20 % 10 = 0</span>
<span class="token comment">#  10 != 20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="关系运算符"><a href="#关系运算符" class="header-anchor">#</a> 关系运算符</h3> <p>关系运算符只支持数字，不支持字符串，除非字符串的值是数字。</p> <p>下表列出了常用的关系运算符，假定变量 x 为 10，变量 y 为 20：</p> <table><thead><tr><th>运算符</th> <th>说明</th> <th>举例</th></tr></thead> <tbody><tr><td><code>-eq</code></td> <td>检测两个数是否相等，相等返回 true。</td> <td><code>[ $a -eq $b ]</code>返回 false。</td></tr> <tr><td><code>-ne</code></td> <td>检测两个数是否相等，不相等返回 true。</td> <td><code>[ $a -ne $b ]</code> 返回 true。</td></tr> <tr><td><code>-gt</code></td> <td>检测左边的数是否大于右边的，如果是，则返回 true。</td> <td><code>[ $a -gt $b ]</code> 返回 false。</td></tr> <tr><td><code>-lt</code></td> <td>检测左边的数是否小于右边的，如果是，则返回 true。</td> <td><code>[ $a -lt $b ]</code> 返回 true。</td></tr> <tr><td><code>-ge</code></td> <td>检测左边的数是否大于等于右边的，如果是，则返回 true。</td> <td><code>[ $a -ge $b ]</code> 返回 false。</td></tr> <tr><td><code>-le</code></td> <td>检测左边的数是否小于等于右边的，如果是，则返回 true。</td> <td><code>[ $a -le $b ]</code>返回 true。</td></tr></tbody></table> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">20</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;x=<span class="token variable">${x}</span>, y=<span class="token variable">${y}</span>&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -eq <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -eq <span class="token variable">${y}</span> : x 等于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -eq <span class="token variable">${y}</span>: x 不等于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -ne <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -ne <span class="token variable">${y}</span>: x 不等于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -ne <span class="token variable">${y}</span>: x 等于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -gt <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -gt <span class="token variable">${y}</span>: x 大于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -gt <span class="token variable">${y}</span>: x 不大于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -lt <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -lt <span class="token variable">${y}</span>: x 小于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -lt <span class="token variable">${y}</span>: x 不小于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -ge <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -ge <span class="token variable">${y}</span>: x 大于或等于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -ge <span class="token variable">${y}</span>: x 小于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -le <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -le <span class="token variable">${y}</span>: x 小于或等于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -le <span class="token variable">${y}</span>: x 大于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token comment">#  Execute: ./operator-demo2.sh</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  x=10, y=20</span>
<span class="token comment">#  10 -eq 20: x 不等于 y</span>
<span class="token comment">#  10 -ne 20: x 不等于 y</span>
<span class="token comment">#  10 -gt 20: x 不大于 y</span>
<span class="token comment">#  10 -lt 20: x 小于 y</span>
<span class="token comment">#  10 -ge 20: x 小于 y</span>
<span class="token comment">#  10 -le 20: x 小于或等于 y</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h3 id="布尔运算符"><a href="#布尔运算符" class="header-anchor">#</a> 布尔运算符</h3> <p>下表列出了常用的布尔运算符，假定变量 x 为 10，变量 y 为 20：</p> <table><thead><tr><th>运算符</th> <th>说明</th> <th>举例</th></tr></thead> <tbody><tr><td><code>!</code></td> <td>非运算，表达式为 true 则返回 false，否则返回 true。</td> <td><code>[ ! false ]</code> 返回 true。</td></tr> <tr><td><code>-o</code></td> <td>或运算，有一个表达式为 true 则返回 true。</td> <td><code>[ $a -lt 20 -o $b -gt 100 ]</code> 返回 true。</td></tr> <tr><td><code>-a</code></td> <td>与运算，两个表达式都为 true 才返回 true。</td> <td><code>[ $a -lt 20 -a $b -gt 100 ]</code> 返回 false。</td></tr></tbody></table> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">20</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;x=<span class="token variable">${x}</span>, y=<span class="token variable">${y}</span>&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token operator">!=</span> <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> != <span class="token variable">${y}</span> : x 不等于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> != <span class="token variable">${y}</span>: x 等于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -lt <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">${y}</span> -gt <span class="token number">15</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> 小于 100 且 <span class="token variable">${y}</span> 大于 15 : 返回 true&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> 小于 100 且 <span class="token variable">${y}</span> 大于 15 : 返回 false&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -lt <span class="token number">100</span> <span class="token operator">||</span> <span class="token variable">${y}</span> -gt <span class="token number">100</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> 小于 100 或 <span class="token variable">${y}</span> 大于 100 : 返回 true&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> 小于 100 或 <span class="token variable">${y}</span> 大于 100 : 返回 false&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -lt <span class="token number">5</span> <span class="token operator">||</span> <span class="token variable">${y}</span> -gt <span class="token number">100</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> 小于 5 或 <span class="token variable">${y}</span> 大于 100 : 返回 true&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> 小于 5 或 <span class="token variable">${y}</span> 大于 100 : 返回 false&quot;</span>
<span class="token keyword">fi</span>

<span class="token comment">#  Execute: ./operator-demo3.sh</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  x=10, y=20</span>
<span class="token comment">#  10 != 20 : x 不等于 y</span>
<span class="token comment">#  10 小于 100 且 20 大于 15 : 返回 true</span>
<span class="token comment">#  10 小于 100 或 20 大于 100 : 返回 true</span>
<span class="token comment">#  10 小于 5 或 20 大于 100 : 返回 false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="逻辑运算符"><a href="#逻辑运算符" class="header-anchor">#</a> 逻辑运算符</h3> <p>以下介绍 Shell 的逻辑运算符，假定变量 x 为 10，变量 y 为 20:</p> <table><thead><tr><th>运算符</th> <th>说明</th> <th>举例</th></tr></thead> <tbody><tr><td><code>&amp;&amp;</code></td> <td>逻辑的 AND</td> <td><code>[[ ${x} -lt 100 &amp;&amp; ${y} -gt 100 ]]</code> 返回 false</td></tr> <tr><td><code>||</code></td> <td>逻辑的 OR</td> <td><code>[[ ${x} -lt 100 || ${y} -gt 100 ]]</code> 返回 true</td></tr></tbody></table> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">20</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;x=<span class="token variable">${x}</span>, y=<span class="token variable">${y}</span>&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -lt <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">${y}</span> -gt <span class="token number">100</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -lt 100 &amp;&amp; <span class="token variable">${y}</span> -gt 100 返回 true&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -lt 100 &amp;&amp; <span class="token variable">${y}</span> -gt 100 返回 false&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -lt <span class="token number">100</span> <span class="token operator">||</span> <span class="token variable">${y}</span> -gt <span class="token number">100</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -lt 100 || <span class="token variable">${y}</span> -gt 100 返回 true&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> -lt 100 || <span class="token variable">${y}</span> -gt 100 返回 false&quot;</span>
<span class="token keyword">fi</span>

<span class="token comment">#  Execute: ./operator-demo4.sh</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  x=10, y=20</span>
<span class="token comment">#  10 -lt 100 &amp;&amp; 20 -gt 100 返回 false</span>
<span class="token comment">#  10 -lt 100 || 20 -gt 100 返回 true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="字符串运算符"><a href="#字符串运算符" class="header-anchor">#</a> 字符串运算符</h3> <p>下表列出了常用的字符串运算符，假定变量 a 为 &quot;abc&quot;，变量 b 为 &quot;efg&quot;：</p> <table><thead><tr><th>运算符</th> <th>说明</th> <th>举例</th></tr></thead> <tbody><tr><td><code>=</code></td> <td>检测两个字符串是否相等，相等返回 true。</td> <td><code>[ $a = $b ]</code> 返回 false。</td></tr> <tr><td><code>!=</code></td> <td>检测两个字符串是否相等，不相等返回 true。</td> <td><code>[ $a != $b ]</code> 返回 true。</td></tr> <tr><td><code>-z</code></td> <td>检测字符串长度是否为 0，为 0 返回 true。</td> <td><code>[ -z $a ]</code> 返回 false。</td></tr> <tr><td><code>-n</code></td> <td>检测字符串长度是否为 0，不为 0 返回 true。</td> <td><code>[ -n $a ]</code> 返回 true。</td></tr> <tr><td><code>str</code></td> <td>检测字符串是否为空，不为空返回 true。</td> <td><code>[ $a ]</code> 返回 true。</td></tr></tbody></table> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token string">&quot;abc&quot;</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token string">&quot;xyz&quot;</span>


<span class="token builtin class-name">echo</span> <span class="token string">&quot;x=<span class="token variable">${x}</span>, y=<span class="token variable">${y}</span>&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token operator">=</span> <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> = <span class="token variable">${y}</span> : x 等于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> = <span class="token variable">${y}</span>: x 不等于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token operator">!=</span> <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> != <span class="token variable">${y}</span> : x 不等于 y&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> != <span class="token variable">${y}</span>: x 等于 y&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -z <span class="token variable">${x}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;-z <span class="token variable">${x}</span> : 字符串长度为 0&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;-z <span class="token variable">${x}</span> : 字符串长度不为 0&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -n <span class="token string">&quot;<span class="token variable">${x}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;-n <span class="token variable">${x}</span> : 字符串长度不为 0&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;-n <span class="token variable">${x}</span> : 字符串长度为 0&quot;</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> : 字符串不为空&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> : 字符串为空&quot;</span>
<span class="token keyword">fi</span>

<span class="token comment">#  Execute: ./operator-demo5.sh</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  x=abc, y=xyz</span>
<span class="token comment">#  abc = xyz: x 不等于 y</span>
<span class="token comment">#  abc != xyz : x 不等于 y</span>
<span class="token comment">#  -z abc : 字符串长度不为 0</span>
<span class="token comment">#  -n abc : 字符串长度不为 0</span>
<span class="token comment">#  abc : 字符串不为空</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="文件测试运算符"><a href="#文件测试运算符" class="header-anchor">#</a> 文件测试运算符</h3> <p>文件测试运算符用于检测 Unix 文件的各种属性。</p> <p>属性检测描述如下：</p> <table><thead><tr><th>操作符</th> <th>说明</th> <th>举例</th></tr></thead> <tbody><tr><td>-b file</td> <td>检测文件是否是块设备文件，如果是，则返回 true。</td> <td><code>[ -b $file ]</code> 返回 false。</td></tr> <tr><td>-c file</td> <td>检测文件是否是字符设备文件，如果是，则返回 true。</td> <td><code>[ -c $file ]</code> 返回 false。</td></tr> <tr><td>-d file</td> <td>检测文件是否是目录，如果是，则返回 true。</td> <td><code>[ -d $file ]</code> 返回 false。</td></tr> <tr><td>-f file</td> <td>检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true。</td> <td><code>[ -f $file ]</code> 返回 true。</td></tr> <tr><td>-g file</td> <td>检测文件是否设置了 SGID 位，如果是，则返回 true。</td> <td><code>[ -g $file ]</code> 返回 false。</td></tr> <tr><td>-k file</td> <td>检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true。</td> <td><code>[ -k $file ]</code>返回 false。</td></tr> <tr><td>-p file</td> <td>检测文件是否是有名管道，如果是，则返回 true。</td> <td><code>[ -p $file ]</code> 返回 false。</td></tr> <tr><td>-u file</td> <td>检测文件是否设置了 SUID 位，如果是，则返回 true。</td> <td><code>[ -u $file ]</code> 返回 false。</td></tr> <tr><td>-r file</td> <td>检测文件是否可读，如果是，则返回 true。</td> <td><code>[ -r $file ]</code> 返回 true。</td></tr> <tr><td>-w file</td> <td>检测文件是否可写，如果是，则返回 true。</td> <td><code>[ -w $file ]</code> 返回 true。</td></tr> <tr><td>-x file</td> <td>检测文件是否可执行，如果是，则返回 true。</td> <td><code>[ -x $file ]</code> 返回 true。</td></tr> <tr><td>-s file</td> <td>检测文件是否为空（文件大小是否大于 0），不为空返回 true。</td> <td><code>[ -s $file ]</code> 返回 true。</td></tr> <tr><td>-e file</td> <td>检测文件（包括目录）是否存在，如果是，则返回 true。</td> <td><code>[ -e $file ]</code> 返回 true。</td></tr></tbody></table> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">file</span><span class="token operator">=</span><span class="token string">&quot;/etc/hosts&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -r <span class="token variable">${file}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件可读&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件不可读&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -w <span class="token variable">${file}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件可写&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件不可写&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -x <span class="token variable">${file}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件可执行&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件不可执行&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -f <span class="token variable">${file}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件为普通文件&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件为特殊文件&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -d <span class="token variable">${file}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件是个目录&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件不是个目录&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -s <span class="token variable">${file}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件不为空&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件为空&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -e <span class="token variable">${file}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件存在&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${file}</span> 文件不存在&quot;</span>
<span class="token keyword">fi</span>

<span class="token comment">#  Execute: ./operator-demo6.sh</span>
<span class="token comment">#  Output:(根据文件的实际情况，输出结果可能不同)</span>
<span class="token comment">#  /etc/hosts 文件可读</span>
<span class="token comment">#  /etc/hosts 文件可写</span>
<span class="token comment">#  /etc/hosts 文件不可执行</span>
<span class="token comment">#  /etc/hosts 文件为普通文件</span>
<span class="token comment">#  /etc/hosts 文件不是个目录</span>
<span class="token comment">#  /etc/hosts 文件不为空</span>
<span class="token comment">#  /etc/hosts 文件存在</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="控制语句"><a href="#控制语句" class="header-anchor">#</a> 控制语句</h2> <h3 id="条件语句"><a href="#条件语句" class="header-anchor">#</a> 条件语句</h3> <p>跟其它程序设计语言一样，Bash 中的条件语句让我们可以决定一个操作是否被执行。结果取决于一个包在<code>[[ ]]</code>里的表达式。</p> <p>由<code>[[ ]]</code>（<code>sh</code>中是<code>[ ]</code>）包起来的表达式被称作 <strong>检测命令</strong> 或 <strong>基元</strong>。这些表达式帮助我们检测一个条件的结果。</p> <p>共有两个不同的条件表达式：<code>if</code>和<code>case</code>。</p> <h4 id="if"><a href="#if" class="header-anchor">#</a> <code>if</code></h4> <p>（1）<code>if</code> 语句</p> <p><code>if</code>在使用上跟其它语言相同。如果中括号里的表达式为真，那么<code>then</code>和<code>fi</code>之间的代码会被执行。<code>fi</code>标志着条件代码块的结束。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 写成一行</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span> -eq <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;1 -eq 1 result is: true&quot;</span><span class="token punctuation">;</span> <span class="token keyword">fi</span>
<span class="token comment"># Output: 1 -eq 1 result is: true</span>

<span class="token comment"># 写成多行</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;abc&quot;</span> -eq <span class="token string">&quot;abc&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span>abc<span class="token string">&quot; -eq &quot;</span>abc<span class="token string">&quot; result is: true&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment"># Output: abc -eq abc result is: true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>（2）<code>if else</code> 语句</p> <p>同样，我们可以使用<code>if..else</code>语句，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">2</span> -ne <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;true&quot;</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;false&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment"># Output: true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>（3）<code>if elif else</code> 语句</p> <p>有些时候，<code>if..else</code>不能满足我们的要求。别忘了<code>if..elif..else</code>，使用起来也很方便。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token operator">&gt;</span> <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> &gt; <span class="token variable">${y}</span>&quot;</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> <span class="token operator">&lt;</span> <span class="token variable">${y}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> &lt; <span class="token variable">${y}</span>&quot;</span>
<span class="token keyword">else</span>
   <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> = <span class="token variable">${y}</span>&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment"># Output: 10 &lt; 20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="case"><a href="#case" class="header-anchor">#</a> <code>case</code></h4> <p>如果你需要面对很多情况，分别要采取不同的措施，那么使用<code>case</code>会比嵌套的<code>if</code>更有用。使用<code>case</code>来解决复杂的条件判断，看起来像下面这样：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">10</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">20</span>
<span class="token assign-left variable">oper</span><span class="token operator">=</span><span class="token string">&quot;+&quot;</span>
<span class="token builtin class-name">exec</span>
<span class="token keyword">case</span> <span class="token variable">${oper}</span> <span class="token keyword">in</span>
  <span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> + $<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token variable">`</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> + <span class="token variable">${y}</span> = <span class="token variable">${val}</span>&quot;</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> - $<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token variable">`</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> - <span class="token variable">${y}</span> = <span class="token variable">${val}</span>&quot;</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> <span class="token punctuation">\</span>* $<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token variable">`</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> * <span class="token variable">${y}</span> = <span class="token variable">${val}</span>&quot;</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">val</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> / $<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token variable">`</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${x}</span> / <span class="token variable">${y}</span> = <span class="token variable">${val}</span>&quot;</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  *<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Unknown oper!&quot;</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>每种情况都是匹配了某个模式的表达式。<code>|</code>用来分割多个模式，<code>)</code>用来结束一个模式序列。第一个匹配上的模式对应的命令将会被执行。<code>*</code>代表任何不匹配以上给定模式的模式。命令块儿之间要用<code>;;</code>分隔。</p> <h3 id="循环语句"><a href="#循环语句" class="header-anchor">#</a> 循环语句</h3> <p>循环其实不足为奇。跟其它程序设计语言一样，bash 中的循环也是只要控制条件为真就一直迭代执行的代码块。</p> <p>Bash 中有四种循环：<code>for</code>，<code>while</code>，<code>until</code>和<code>select</code>。</p> <h4 id="for循环"><a href="#for循环" class="header-anchor">#</a> <code>for</code>循环</h4> <p><code>for</code>与它在 C 语言中的姊妹非常像。看起来是这样：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token keyword">for</span> <span class="token for-or-select variable">arg</span> <span class="token keyword">in</span> elem1 elem2 <span class="token punctuation">..</span>. elemN
<span class="token keyword">do</span>
  <span class="token comment">### 语句</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在每次循环的过程中，<code>arg</code>依次被赋值为从<code>elem1</code>到<code>elemN</code>。这些值还可以是通配符或者<mark>大括号扩展</mark>。</p> <p>当然，我们还可以把<code>for</code>循环写在一行，但这要求<code>do</code>之前要有一个分号，就像下面这样：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token variable">$i</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>还有，如果你觉得<code>for..in..do</code>对你来说有点奇怪，那么你也可以像 C 语言那样使用<code>for</code>，比如：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token variable">$i</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当我们想对一个目录下的所有文件做同样的操作时，<code>for</code>就很方便了。举个例子，如果我们想把所有的<code>.bash</code>文件移动到<code>script</code>文件夹中，并给它们可执行权限，我们的脚本可以这样写：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">DIR</span><span class="token operator">=</span>/home/zp
<span class="token keyword">for</span> <span class="token for-or-select variable">FILE</span> <span class="token keyword">in</span> <span class="token variable">${DIR}</span>/*.sh<span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token function">mv</span> <span class="token string">&quot;<span class="token variable">$FILE</span>&quot;</span> <span class="token string">&quot;<span class="token variable">${DIR}</span>/scripts&quot;</span>
<span class="token keyword">done</span>
<span class="token comment"># 将 /home/zp 目录下所有 sh 文件拷贝到 /home/zp/scripts</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="while循环"><a href="#while循环" class="header-anchor">#</a> <code>while</code>循环</h4> <p><code>while</code>循环检测一个条件，只要这个条件为 <em>真</em>，就执行一段命令。被检测的条件跟<code>if..then</code>中使用的基原并无二异。因此一个<code>while</code>循环看起来会是这样：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token keyword">while</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> condition <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">do</span>
  <span class="token comment">### 语句</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>跟<code>for</code>循环一样，如果我们把<code>do</code>和被检测的条件写到一行，那么必须要在<code>do</code>之前加一个分号。</p> <p>比如下面这个例子：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">### 0到9之间每个数的平方</span>
<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -lt <span class="token number">10</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>x <span class="token operator">*</span> x<span class="token variable">))</span></span>
  <span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
<span class="token keyword">done</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  0</span>
<span class="token comment">#  1</span>
<span class="token comment">#  4</span>
<span class="token comment">#  9</span>
<span class="token comment">#  16</span>
<span class="token comment">#  25</span>
<span class="token comment">#  36</span>
<span class="token comment">#  49</span>
<span class="token comment">#  64</span>
<span class="token comment">#  81</span>
复制代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="until循环"><a href="#until循环" class="header-anchor">#</a> <code>until</code>循环</h4> <p><code>until</code>循环跟<code>while</code>循环正好相反。它跟<code>while</code>一样也需要检测一个测试条件，但不同的是，只要该条件为 <em>假</em> 就一直执行循环：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">until</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${x}</span> -ge <span class="token number">5</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token variable">${x}</span>
  <span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>x<span class="token punctuation">}</span> + <span class="token number">1</span><span class="token variable">`</span></span>
<span class="token keyword">done</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  0</span>
<span class="token comment">#  1</span>
<span class="token comment">#  2</span>
<span class="token comment">#  3</span>
<span class="token comment">#  4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="-2"><a href="#-2" class="header-anchor">#</a></h4> <p><code>select</code>循环帮助我们组织一个用户菜单。它的语法几乎跟<code>for</code>循环一致：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token keyword">select</span> <span class="token for-or-select variable">answer</span> <span class="token keyword">in</span> elem1 elem2 <span class="token punctuation">..</span>. elemN
<span class="token keyword">do</span>
  <span class="token comment">### 语句</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>select</code>会打印<code>elem1..elemN</code>以及它们的序列号到屏幕上，之后会提示用户输入。通常看到的是<code>$?</code>（<code>PS3</code>变量）。用户的选择结果会被保存到<code>answer</code>中。如果<code>answer</code>是一个在<code>1..N</code>之间的数字，那么<code>语句</code>会被执行，紧接着会进行下一次迭代 —— 如果不想这样的话我们可以使用<code>break</code>语句。</p> <p>一个可能的实例可能会是这样：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env bash</span>

<span class="token assign-left variable"><span class="token environment constant">PS3</span></span><span class="token operator">=</span><span class="token string">&quot;Choose the package manager: &quot;</span>
<span class="token keyword">select</span> <span class="token for-or-select variable">ITEM</span> <span class="token keyword">in</span> bower <span class="token function">npm</span> gem pip
<span class="token keyword">do</span>
<span class="token builtin class-name">echo</span> -n <span class="token string">&quot;Enter the package name: &quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">read</span> PACKAGE
<span class="token keyword">case</span> <span class="token variable">${ITEM}</span> <span class="token keyword">in</span>
  bower<span class="token punctuation">)</span> bower <span class="token function">install</span> <span class="token variable">${PACKAGE}</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token function">npm</span><span class="token punctuation">)</span> <span class="token function">npm</span> <span class="token function">install</span> <span class="token variable">${PACKAGE}</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
  gem<span class="token punctuation">)</span> gem <span class="token function">install</span> <span class="token variable">${PACKAGE}</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
  pip<span class="token punctuation">)</span> pip <span class="token function">install</span> <span class="token variable">${PACKAGE}</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
<span class="token builtin class-name">break</span> <span class="token comment"># 避免无限循环</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这个例子，先询问用户他想使用什么包管理器。接着，又询问了想安装什么包，最后执行安装操作。</p> <p>运行这个脚本，会得到如下输出：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ ./my_script
<span class="token number">1</span><span class="token punctuation">)</span> bower
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token function">npm</span>
<span class="token number">3</span><span class="token punctuation">)</span> gem
<span class="token number">4</span><span class="token punctuation">)</span> pip
Choose the package manager: <span class="token number">2</span>
Enter the package name: gitbook-cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="break-和-continue"><a href="#break-和-continue" class="header-anchor">#</a> <code>break</code> 和 <code>continue</code></h4> <p>如果想提前结束一个循环或跳过某次循环执行，可以使用 shell 的<code>break</code>和<code>continue</code>语句来实现。它们可以在任何循环中使用。</p> <blockquote><p><code>break</code>语句用来提前结束当前循环。</p> <p><code>continue</code>语句用来跳过某次迭代。</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查找 10 以内第一个能整除 2 和 3 的正整数</span>
<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">${i}</span> -lt <span class="token number">10</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$((</span>i <span class="token operator">%</span> <span class="token number">3</span><span class="token variable">))</span></span> -eq <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$((</span>i <span class="token operator">%</span> <span class="token number">2</span><span class="token variable">))</span></span> -eq <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">${i}</span>
    <span class="token builtin class-name">break</span><span class="token punctuation">;</span>
  <span class="token keyword">fi</span>
  <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>i<span class="token punctuation">}</span> + <span class="token number">1</span><span class="token variable">`</span></span>
<span class="token keyword">done</span>
<span class="token comment"># Output: 6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 打印10以内的奇数</span>
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$((</span>i <span class="token operator">%</span> <span class="token number">2</span><span class="token variable">))</span></span> -eq <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">continue</span><span class="token punctuation">;</span>
  <span class="token keyword">fi</span>
  <span class="token builtin class-name">echo</span> <span class="token variable">${i}</span>
<span class="token keyword">done</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  1</span>
<span class="token comment">#  3</span>
<span class="token comment">#  5</span>
<span class="token comment">#  7</span>
<span class="token comment">#  9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h2> <p>bash 函数定义语法如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span> <span class="token keyword">function</span> <span class="token punctuation">]</span> funname <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    action<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>return int<span class="token punctuation">;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>💡 说明：</p> <ol><li>函数定义时，<code>function</code> 关键字可有可无。</li> <li>函数返回值 - return 返回函数返回值，返回值类型只能为整数（0-255）。如果不加 return 语句，shell 默认将以最后一条命令的运行结果，作为函数返回值。</li> <li>函数返回值在调用该函数后通过 <code>$?</code> 来获得。</li> <li>所有函数在使用前必须定义。这意味着必须将函数放在脚本开始部分，直至 shell 解释器首次发现它时，才可以使用。调用函数仅使用其函数名即可。</li></ol></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env bash</span>

<span class="token function-name function">calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token assign-left variable"><span class="token environment constant">PS3</span></span><span class="token operator">=</span><span class="token string">&quot;choose the oper: &quot;</span>
  <span class="token keyword">select</span> <span class="token for-or-select variable">oper</span> <span class="token keyword">in</span> + - <span class="token punctuation">\</span>* / <span class="token comment"># 生成操作符选择菜单</span>
  <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> -n <span class="token string">&quot;enter first num: &quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">read</span> x <span class="token comment"># 读取输入参数</span>
  <span class="token builtin class-name">echo</span> -n <span class="token string">&quot;enter second num: &quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">read</span> y <span class="token comment"># 读取输入参数</span>
  <span class="token builtin class-name">exec</span>
  <span class="token keyword">case</span> <span class="token variable">${oper}</span> <span class="token keyword">in</span>
    <span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span>
      <span class="token builtin class-name">return</span> <span class="token variable"><span class="token variable">$((</span>${x} <span class="token operator">+</span> ${y}<span class="token variable">))</span></span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span>
      <span class="token builtin class-name">return</span> <span class="token variable"><span class="token variable">$((</span>${x} <span class="token operator">-</span> ${y}<span class="token variable">))</span></span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span>
      <span class="token builtin class-name">return</span> <span class="token variable"><span class="token variable">$((</span>${x} <span class="token operator">*</span> ${y}<span class="token variable">))</span></span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
      <span class="token builtin class-name">return</span> <span class="token variable"><span class="token variable">$((</span>${x} <span class="token operator">/</span> ${y}<span class="token variable">))</span></span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${oper}</span> is not support!&quot;</span>
      <span class="token builtin class-name">return</span> <span class="token number">0</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token keyword">esac</span>
  <span class="token builtin class-name">break</span>
  <span class="token keyword">done</span>
<span class="token punctuation">}</span>
calc
<span class="token builtin class-name">echo</span> <span class="token string">&quot;the result is: <span class="token variable">$?</span>&quot;</span> <span class="token comment"># $? 获取 calc 函数返回值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>执行结果：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ ./function-demo.sh
<span class="token number">1</span><span class="token punctuation">)</span> +
<span class="token number">2</span><span class="token punctuation">)</span> -
<span class="token number">3</span><span class="token punctuation">)</span> *
<span class="token number">4</span><span class="token punctuation">)</span> /
choose the oper: <span class="token number">3</span>
enter first num: <span class="token number">10</span>
enter second num: <span class="token number">10</span>
the result is: <span class="token number">100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="位置参数"><a href="#位置参数" class="header-anchor">#</a> 位置参数</h3> <p><strong>位置参数</strong>是在调用一个函数并传给它参数时创建的变量。</p> <p>位置参数变量表：</p> <table><thead><tr><th>变量</th> <th>描述</th></tr></thead> <tbody><tr><td><code>$0</code></td> <td>脚本名称</td></tr> <tr><td><code>$1 … $9</code></td> <td>第 1 个到第 9 个参数列表</td></tr> <tr><td><code>${10} … ${N}</code></td> <td>第 10 个到 N 个参数列表</td></tr> <tr><td><code>$*</code> or <code>$@</code></td> <td>除了<code>$0</code>外的所有位置参数</td></tr> <tr><td><code>$#</code></td> <td>不包括<code>$0</code>在内的位置参数的个数</td></tr> <tr><td><code>$FUNCNAME</code></td> <td>函数名称（仅在函数内部有值）</td></tr></tbody></table> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env bash</span>

<span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -n <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;第一个参数为：<span class="token variable">$1</span>&quot;</span>
  <span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;第一个参数为空&quot;</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -n <span class="token variable">$2</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;第二个参数为：<span class="token variable">$2</span>&quot;</span>
  <span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;第二个参数为空&quot;</span>
<span class="token keyword">fi</span>

<span class="token function-name function">paramsFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;函数第一个入参：<span class="token variable">$1</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;函数第二个入参：<span class="token variable">$2</span>&quot;</span>
<span class="token punctuation">}</span>
paramsFunction <span class="token variable">${x}</span> <span class="token variable">${y}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>执行结果：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ ./function-demo2.sh
第一个参数为空
第二个参数为空
函数第一个入参：0
函数第二个入参：0

$ ./function-demo2.sh <span class="token number">10</span> <span class="token number">20</span>
第一个参数为：10
第二个参数为：20
函数第一个入参：10
函数第二个入参：20
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>执行 <code>./variable-demo4.sh hello world</code> ，然后在脚本中通过 <code>$1</code>、<code>$2</code> ... 读取第 1 个参数、第 2 个参数。。。</p> <h3 id="函数处理参数"><a href="#函数处理参数" class="header-anchor">#</a> 函数处理参数</h3> <p>另外，还有几个特殊字符用来处理参数：</p> <table><thead><tr><th>参数处理</th> <th>说明</th></tr></thead> <tbody><tr><td><code>$#</code></td> <td>返回参数个数</td></tr> <tr><td><code>$*</code></td> <td>返回所有参数</td></tr> <tr><td><code>?</code></td> <td>脚本运行的当前进程 ID 号</td></tr> <tr><td><code>$!</code></td> <td>后台运行的最后一个进程的 ID 号</td></tr> <tr><td><code>$@</code></td> <td>返回所有参数</td></tr> <tr><td><code>$-</code></td> <td>返回 Shell 使用的当前选项，与 set 命令功能相同。</td></tr> <tr><td><code>$?</code></td> <td>函数返回值</td></tr></tbody></table> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function-name function">runner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin class-name">return</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token assign-left variable">name</span><span class="token operator">=</span>zp
<span class="token function-name function">paramsFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;函数第一个入参：<span class="token variable">$1</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;函数第二个入参：<span class="token variable">$2</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;传递到脚本的参数个数：<span class="token variable">$#</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;所有参数：&quot;</span>
  <span class="token builtin class-name">printf</span> <span class="token string">&quot;+ %s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$*</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;脚本运行的当前进程 ID 号：?&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;后台运行的最后一个进程的 ID 号：<span class="token variable">$!</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;所有参数：&quot;</span>
  <span class="token builtin class-name">printf</span> <span class="token string">&quot;+ %s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;Shell 使用的当前选项：$-&quot;</span>
  runner
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;runner 函数的返回值：<span class="token variable">$?</span>&quot;</span>
<span class="token punctuation">}</span>
paramsFunction <span class="token number">1</span> <span class="token string">&quot;abc&quot;</span> <span class="token string">&quot;hello, <span class="token entity" title="\&quot;">\&quot;</span>zp<span class="token entity" title="\&quot;">\&quot;</span>&quot;</span>
<span class="token comment">#  Output:</span>
<span class="token comment">#  函数第一个入参：1</span>
<span class="token comment">#  函数第二个入参：abc</span>
<span class="token comment">#  传递到脚本的参数个数：3</span>
<span class="token comment">#  所有参数：</span>
<span class="token comment">#  + 1 abc hello, &quot;zp&quot;</span>
<span class="token comment">#  脚本运行的当前进程 ID 号：26400</span>
<span class="token comment">#  后台运行的最后一个进程的 ID 号：</span>
<span class="token comment">#  所有参数：</span>
<span class="token comment">#  + 1</span>
<span class="token comment">#  + abc</span>
<span class="token comment">#  + hello, &quot;zp&quot;</span>
<span class="token comment">#  Shell 使用的当前选项：hB</span>
<span class="token comment">#  runner 函数的返回值：0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="shell-扩展"><a href="#shell-扩展" class="header-anchor">#</a> Shell 扩展</h2> <p><em>扩展</em> 发生在一行命令被分成一个个的 <em>记号（tokens）</em> 之后。换言之，扩展是一种执行数学运算的机制，还可以用来保存命令的执行结果，等等。</p> <p>感兴趣的话可以阅读<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.gnu.org%2Fsoftware%2Fbash%2Fmanual%2Fbash.html%23%23%23Shell-Expansions" target="_blank" rel="noopener noreferrer">关于 shell 扩展的更多细节<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h4 id="大括号扩展"><a href="#大括号扩展" class="header-anchor">#</a> 大括号扩展</h4> <p>大括号扩展让生成任意的字符串成为可能。它跟 <em>文件名扩展</em> 很类似，举个例子：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> beg<span class="token punctuation">{</span>i,a,u<span class="token punctuation">}</span>n <span class="token comment">### begin began begun</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>大括号扩展还可以用来创建一个可被循环迭代的区间。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">}</span> <span class="token comment">### 0 1 2 3 4 5</span>
<span class="token builtin class-name">echo</span> <span class="token punctuation">{</span>00<span class="token punctuation">..</span><span class="token number">8</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token comment">### 00 02 04 06 08</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="命令置换"><a href="#命令置换" class="header-anchor">#</a> 命令置换</h4> <p>命令置换允许我们对一个命令求值，并将其值置换到另一个命令或者变量赋值表达式中。当一个命令被``或<code>$()</code>包围时，命令置换将会执行。举个例子：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">now</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +%T<span class="token variable">`</span></span>
<span class="token comment">### or</span>
<span class="token assign-left variable">now</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%T<span class="token variable">)</span></span>

<span class="token builtin class-name">echo</span> <span class="token variable">$now</span> <span class="token comment">### 19:08:26</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="算数扩展"><a href="#算数扩展" class="header-anchor">#</a> 算数扩展</h4> <p>在 bash 中，执行算数运算是非常方便的。算数表达式必须包在<code>$(( ))</code>中。算数扩展的格式为：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span> <span class="token punctuation">((</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token variable">))</span></span>
<span class="token builtin class-name">echo</span> <span class="token variable">$result</span> <span class="token comment">### 9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在算数表达式中，使用变量无需带上<code>$</code>前缀：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">4</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">7</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span> x <span class="token operator">+</span> y <span class="token variable">))</span></span>     <span class="token comment">### 11</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span> <span class="token operator">++</span>x <span class="token operator">+</span> y<span class="token operator">++</span> <span class="token variable">))</span></span> <span class="token comment">### 12</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span> x <span class="token operator">+</span> y <span class="token variable">))</span></span>     <span class="token comment">### 13</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="单引号和双引号-2"><a href="#单引号和双引号-2" class="header-anchor">#</a> 单引号和双引号</h4> <p>单引号和双引号之间有很重要的区别。在双引号中，变量引用或者命令置换是会被展开的。在单引号中是不会的。举个例子：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;Your home: <span class="token environment constant">$HOME</span>&quot;</span> <span class="token comment">### Your home: /Users/&lt;username&gt;</span>
<span class="token builtin class-name">echo</span> <span class="token string">'Your home: $HOME'</span> <span class="token comment">### Your home: $HOME</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>当局部变量和环境变量包含空格时，它们在引号中的扩展要格外注意。随便举个例子，假如我们用<code>echo</code>来输出用户的输入：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">INPUT</span><span class="token operator">=</span><span class="token string">&quot;A string  with   strange    whitespace.&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$INPUT</span>   <span class="token comment">### A string with strange whitespace.</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$INPUT</span>&quot;</span> <span class="token comment">### A string  with   strange    whitespace.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>调用第一个<code>echo</code>时给了它 5 个单独的参数 —— <code>$INPUT</code> 被分成了单独的词，<code>echo</code>在每个词之间打印了一个空格。第二种情况，调用<code>echo</code>时只给了它一个参数（整个$INPUT 的值，包括其中的空格）。</p> <p>来看一个更严肃的例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">FILE</span><span class="token operator">=</span><span class="token string">&quot;Favorite Things.txt&quot;</span>
<span class="token function">cat</span> <span class="token variable">$FILE</span>   <span class="token comment">### 尝试输出两个文件: `Favorite` 和 `Things.txt`</span>
<span class="token function">cat</span> <span class="token string">&quot;<span class="token variable">$FILE</span>&quot;</span> <span class="token comment">### 输出一个文件: `Favorite Things.txt`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>尽管这个问题可以通过把 FILE 重命名成<code>Favorite-Things.txt</code>来解决，但是，假如这个值来自某个环境变量，来自一个位置参数，或者来自其它命令（<code>find</code>, <code>cat</code>, 等等）呢。因此，如果输入 <em>可能</em> 包含空格，务必要用引号把表达式包起来。</p> <h2 id="流和重定向"><a href="#流和重定向" class="header-anchor">#</a> 流和重定向</h2> <h3 id="输入、输出流"><a href="#输入、输出流" class="header-anchor">#</a> 输入、输出流</h3> <p>Bash 接收输入，并以字符序列或 <strong>字符流</strong> 的形式产生输出。这些流能被重定向到文件或另一个流中。</p> <p>有三个文件描述符：</p> <table><thead><tr><th>代码</th> <th>描述符</th> <th>描述</th></tr></thead> <tbody><tr><td><code>0</code></td> <td><code>stdin</code></td> <td>标准输入</td></tr> <tr><td><code>1</code></td> <td><code>stdout</code></td> <td>标准输出</td></tr> <tr><td><code>2</code></td> <td><code>stderr</code></td> <td>标准错误输出</td></tr></tbody></table> <h3 id="重定向"><a href="#重定向" class="header-anchor">#</a> 重定向</h3> <p>重定向让我们可以控制一个命令的输入来自哪里，输出结果到什么地方。这些运算符在控制流的重定向时会被用到：</p> <table><thead><tr><th>Operator</th> <th>Description</th></tr></thead> <tbody><tr><td><code>&gt;</code></td> <td>重定向输出</td></tr> <tr><td><code>&amp;&gt;</code></td> <td>重定向输出和错误输出</td></tr> <tr><td><code>&amp;&gt;&gt;</code></td> <td>以附加的形式重定向输出和错误输出</td></tr> <tr><td><code>&lt;</code></td> <td>重定向输入</td></tr> <tr><td><code>&lt;&lt;</code></td> <td>将开始标记 tag 和结束标记 tag 之间的内容作为输入。</td></tr> <tr><td><code>&lt;&lt;&lt;</code></td> <td><a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.tldp.org%2FLDP%2Fabs%2Fhtml%2Fx17837.html" target="_blank" rel="noopener noreferrer">Here 字符串<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr></tbody></table> <p>以下是一些使用重定向的例子：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">### ls的结果将会被写到list.txt中</span>
<span class="token function">ls</span> -l <span class="token operator">&gt;</span> list.txt

<span class="token comment">### 将输出附加到list.txt中</span>
<span class="token function">ls</span> -a <span class="token operator">&gt;&gt;</span> list.txt

<span class="token comment">### 所有的错误信息会被写到errors.txt中</span>
<span class="token function">grep</span> da * <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> errors.txt

<span class="token comment">### 从errors.txt中读取输入</span>
<span class="token function">less</span> <span class="token operator">&lt;</span> errors.txt

<span class="token comment">#!/bin/bash</span>
<span class="token comment"># author:菜鸟教程</span>
<span class="token comment"># url:www.runoob.com</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
欢迎来到
菜鸟教程
www.runoob.com
EOF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="dev-null-文件"><a href="#dev-null-文件" class="header-anchor">#</a> <code>/dev/null</code> 文件</h3> <p>如果希望执行某个命令，但又不希望在屏幕上显示输出结果，那么可以将输出重定向到 /dev/null：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">command</span> <span class="token operator">&gt;</span> /dev/null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>/dev/null 是一个特殊的文件，写入到它的内容都会被丢弃；如果尝试从该文件读取内容，那么什么也读不到。但是 /dev/null 文件非常有用，将命令的输出重定向到它，会起到&quot;禁止输出&quot;的效果。</p> <p>如果希望屏蔽 stdout 和 stderr，可以这样写：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">command</span> <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="debug"><a href="#debug" class="header-anchor">#</a> Debug</h2> <p>shell 提供了用于 debug 脚本的工具。</p> <p>如果想采用 debug 模式运行某脚本，可以在其 shebang 中使用一个特殊的选项：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash options</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>options 是一些可以改变 shell 行为的选项。下表是一些可能对你有用的选项：</p> <table><thead><tr><th>Short</th> <th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td><code>-f</code></td> <td>noglob</td> <td>禁止文件名展开（globbing）</td></tr> <tr><td><code>-i</code></td> <td>interactive</td> <td>让脚本以 <em>交互</em> 模式运行</td></tr> <tr><td><code>-n</code></td> <td>noexec</td> <td>读取命令，但不执行（语法检查）</td></tr> <tr><td><code>-t</code></td> <td>—</td> <td>执行完第一条命令后退出</td></tr> <tr><td><code>-v</code></td> <td>verbose</td> <td>在执行每条命令前，向<code>stderr</code>输出该命令</td></tr> <tr><td><code>-x</code></td> <td>xtrace</td> <td>在执行每条命令前，向<code>stderr</code>输出该命令以及该命令的扩展参数</td></tr></tbody></table> <p>举个例子，如果我们在脚本中指定了<code>-x</code>例如：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash -x</span>

<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token variable">$i</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这会向<code>stdout</code>打印出变量的值和一些其它有用的信息：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ ./my_script
+ <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">))</span></span>
+ <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">))</span></span>
+ <span class="token builtin class-name">echo</span> <span class="token number">0</span>
<span class="token number">0</span>
+ <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">++</span>  <span class="token punctuation">))</span></span>
+ <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">))</span></span>
+ <span class="token builtin class-name">echo</span> <span class="token number">1</span>
<span class="token number">1</span>
+ <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">++</span>  <span class="token punctuation">))</span></span>
+ <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">))</span></span>
+ <span class="token builtin class-name">echo</span> <span class="token number">2</span>
<span class="token number">2</span>
+ <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">++</span>  <span class="token punctuation">))</span></span>
+ <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">))</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>有时我们值需要 debug 脚本的一部分。这种情况下，使用<code>set</code>命令会很方便。这个命令可以启用或禁用选项。使用<code>-</code>启用选项，<code>+</code>禁用选项：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 开启 debug</span>
<span class="token builtin class-name">set</span> -x
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">printf</span> <span class="token variable">${i}</span>
<span class="token keyword">done</span>
<span class="token comment"># 关闭 debug</span>
<span class="token builtin class-name">set</span> +x
<span class="token comment">#  Output:</span>
<span class="token comment">#  + (( i = 0 ))</span>
<span class="token comment">#  + (( i &lt; 3 ))</span>
<span class="token comment">#  + printf 0</span>
<span class="token comment">#  0+ (( i++  ))</span>
<span class="token comment">#  + (( i &lt; 3 ))</span>
<span class="token comment">#  + printf 1</span>
<span class="token comment">#  1+ (( i++  ))</span>
<span class="token comment">#  + (( i &lt; 3 ))</span>
<span class="token comment">#  + printf 2</span>
<span class="token comment">#  2+ (( i++  ))</span>
<span class="token comment">#  + (( i &lt; 3 ))</span>
<span class="token comment">#  + set +x</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">printf</span> <span class="token variable">${i}</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
<span class="token builtin class-name">printf</span> <span class="token string">&quot;<span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token comment">#  Output: 12345</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="使用curl调试接口"><a href="#使用curl调试接口" class="header-anchor">#</a> 使用curl调试接口</h2> <p>curl是一个多功能的网络客户端命令，可以支持非常多的网络协议，如HTTP、FTP、IMAP、SMTP、SMB、LADP、MQTT等，但大部分情况下，我们将其作为HTTP协议的客户端工具来使用，用来调试HTTP接口，常见用法如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 发送HTTP请求，默认GET方法</span>
<span class="token function">curl</span> <span class="token string">'http://localhost/user/get'</span>

<span class="token comment"># -d指定请求体，有-d参数后，curl会使用POST方法</span>
<span class="token comment"># 如果不指定Content-Type，默认是application/x-www-form-urlencoded</span>
<span class="token function">curl</span> <span class="token string">'http://localhost/user/add'</span> -d <span class="token string">'id=32&amp;name=zhangsan'</span>
<span class="token comment"># --data-urlencode，将请求体做urlencode编码后再发送</span>
<span class="token function">curl</span> <span class="token string">'http://localhost/user/add'</span> --data-urlencode <span class="token string">'id=32&amp;name=zhangsan'</span>

<span class="token comment"># 用-H添加请求头，如下指定Content-Type是application/json</span>
<span class="token function">curl</span> <span class="token string">'http://localhost/user/add'</span> -H <span class="token string">'Content-Type: application/json; charset=UTF-8'</span> -d <span class="token string">'{&quot;id&quot;:32,&quot;name&quot;:&quot;zhangsan&quot;}'</span>

<span class="token comment"># 使用-X，可以指定请求方法</span>
<span class="token function">curl</span> -X DELETE <span class="token string">'http://localhost/user/delete'</span>
<span class="token function">curl</span> -X PUT <span class="token string">'http://localhost/user/modify'</span> -d <span class="token string">'id=32&amp;name=zhangsan'</span>



<span class="token comment"># -G，可以将请求体拼接到url，所以下面两种调用方法是等效的</span>
<span class="token function">curl</span> -G <span class="token string">'http://localhost/user/add'</span> -d <span class="token string">'id=32&amp;name=zhangsan'</span>
<span class="token function">curl</span> <span class="token string">'http://localhost/user/add?id=32&amp;name=zhangsan'</span>

<span class="token comment"># -i和-I可以显示响应头，区别是-i会同时显示响应头与内容，-I只显示响应头</span>
<span class="token function">curl</span> -i <span class="token string">'http://localhost/user/add?id=32&amp;name=zhangsan'</span>

<span class="token comment"># 查看curl处理细节(非常常用)</span>
<span class="token function">curl</span> -v http://www.baidu.com
<span class="token comment"># -s不显示进度提示信息与错误信息，-S显示错误信息</span>
<span class="token function">curl</span> -sS http://www.baidu.com

<span class="token comment"># 使用time执行curl，只能看到请求整体响应时间</span>
$ <span class="token function">time</span> <span class="token function">curl</span> <span class="token string">&quot;http://www.baidu.com&quot;</span> -o /dev/null -s
<span class="token punctuation">..</span>.
real    0m0.066s
user    0m0.010s
sys     0m0.000s
<span class="token comment"># 如下，通过-w可以打印请求详细耗时情况，包括dns查找耗时，连接建立耗时、收到服务端响应的首字节耗时、响应结果全部获取到的耗时，注意时间都是累加的，即相对于命令执行那一刻开始</span>
$ <span class="token function">curl</span> -w <span class="token string">&quot; time_namelookup:%{time_namelookup}s<span class="token entity" title="\n">\n</span> time_connect:%{time_connect}s<span class="token entity" title="\n">\n</span> time_starttransfer:%{time_starttransfer}s<span class="token entity" title="\n">\n</span> time_total:%{time_total}s<span class="token entity" title="\n">\n</span> speed_download:%{speed_download}<span class="token entity" title="\n">\n</span> http_code:%{http_code}&quot;</span> <span class="token string">&quot;http://www.baidu.com&quot;</span> -o /dev/null -s
 time_namelookup:0.009906s
 time_connect:0.035826s
 time_starttransfer:0.062370s
 time_total:0.062406s
 speed_download:38403.000
 http_code:200
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>另外，curl也可以用来做文件上传与下载，如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 下载文件，-L让curl支持重定向，-#显示进度条，-O响应体下载为文件</span>
<span class="token function">curl</span> -LO -<span class="token comment"># http://localhost/user/avatar/xxxxx.png  </span>
<span class="token comment"># wget也经常用于下载文件</span>
<span class="token function">wget</span> http://localhost/user/avatar/xxxxx.png  

<span class="token comment"># 上传文件，-F类似于html里的form，使用-F后，Content-Type默认是multipart/form-data，这正是web上常见的文件上传方式  </span>
<span class="token function">curl</span> http://localhost/user/avatar/upload -F <span class="token string">'id=32'</span> -F <span class="token string">'avatar=@./xxxxx.png'</span>

<span class="token comment"># 上传文件，这也是一种上传文件的方式，请求体直接就是文件内容，整个传给服务器</span>
<span class="token function">curl</span> http://localhost/user/avatar?id<span class="token operator">=</span><span class="token number">32</span> --data-binary <span class="token string">'@./xxxxx.png'</span> -<span class="token comment">#</span>


<span class="token comment"># curl也可以访问ftp服务器，如下：</span>
<span class="token comment"># 下载ftp文件</span>
<span class="token function">curl</span> -u 用户名:密码 ftp://localhost/user/avatar/xxxxx.png -O

<span class="token comment"># 上传文件到ftp</span>
<span class="token function">curl</span> -u 用户名:密码 ftp://localhost/user/avatar/ -T ./xxxxx.png
复制代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>另外，有时使用curl会出现一些莫名其妙的麻烦</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 一些网站https证书过期了，curl报curl: (60) SSL certificate problem: unable to get local issuer certificate</span>
<span class="token comment"># 可以用-k忽略https证书校验</span>
<span class="token function">curl</span> -k https://www.ywnds.com/

<span class="token comment"># 一些网站网速极慢，导致curl会阻塞很久，需要指定下网络超时时间</span>
<span class="token function">curl</span> --connect-timeout <span class="token number">2</span> --max-time <span class="token number">2</span> http://www.baidu.com

<span class="token comment"># 一些网站会使用gzip压缩响应内容，这会导致curl报Warning: Binary output can mess up your terminal. Use &quot;--output -&quot; to tell</span>
<span class="token comment"># 使用--compressed即可，使用gzip -d也可以</span>
<span class="token function">curl</span> -H <span class="token string">'Accept-Encoding:gzip'</span> http://www.baidu.com/ --compressed
<span class="token function">curl</span> -H <span class="token string">'Accept-Encoding:gzip'</span> http://www.baidu.com/ <span class="token operator">|</span> <span class="token function">gzip</span> -d

<span class="token comment"># 一些网站任然在使用GBK编码，这会导致curl结果乱码，甚至直接报Failed writing body错误，这时需要使用iconv转换一下编码</span>
<span class="token function">curl</span> -i http://www.xxxxx.com <span class="token operator">|</span> <span class="token function">iconv</span> -f GBK
<span class="token comment"># 有时，你想在输出响应结果后再输出一个换行，避免多次curl的结果混在一行上</span>
<span class="token function">curl</span> -w <span class="token string">'\n'</span> http://localhost/health
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="使用ssh管理主机"><a href="#使用ssh管理主机" class="header-anchor">#</a> 使用ssh管理主机</h2> <h3 id="登录远程主机"><a href="#登录远程主机" class="header-anchor">#</a> 登录远程主机</h3> <p>一般我们使用ssh来登录并管理远程主机，比如安装软件、排查问题等，常见用法如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 登录到主机192.168.0.1上，使用work用户，然后输入work用户密码即可</span>
$ <span class="token function">ssh</span> work@192.168.0.1

<span class="token comment"># -p指定端口，有时主机为了安全会不使用默认的22端口</span>
$ <span class="token function">ssh</span> work@192.168.0.1 -p <span class="token number">8022</span>

<span class="token comment"># 直接在远程主机上执行命令</span>
$ <span class="token function">ssh</span> work@192.168.0.1 -e <span class="token string">'ping www.baidu.com'</span>
PING www.a.shifen.com <span class="token punctuation">(</span><span class="token number">112.80</span>.248.76<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.
<span class="token number">64</span> bytes from <span class="token number">112.80</span>.248.76 <span class="token punctuation">(</span><span class="token number">112.80</span>.248.76<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">54</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">19.1</span> ms
<span class="token number">64</span> bytes from <span class="token number">112.80</span>.248.76 <span class="token punctuation">(</span><span class="token number">112.80</span>.248.76<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">54</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">19.9</span> ms 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="上传下载文件"><a href="#上传下载文件" class="header-anchor">#</a> 上传下载文件</h3> <p>除了远程登录到主机上，我们经常需要上传下载文件，如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># scp和ssh是一个软件包的，为上传下载场景定制的命令，用法如下：</span>
<span class="token comment"># 下载192.168.0.1主机上/home/work/logs/app.log到本机的logs目录下</span>
$ <span class="token function">scp</span> work@192.168.0.1:/home/work/logs/app.log ./logs/

<span class="token comment"># 上传本机./logs/app.log文件到192.168.0.1主机上/home/work/logs/目录里</span>
$ <span class="token function">scp</span> ./logs/app.log work@192.168.0.1:/home/work/logs/

<span class="token comment"># 实际上scp的源文件与目标文件都可以是远程主机上的，如下：</span>
$ <span class="token function">scp</span> work@192.168.0.1:/home/work/logs/app.log work@192.168.0.2:/home/work/logs/app.log


<span class="token comment"># 实际上使用ssh也能上传下载</span>
<span class="token comment"># 使用ssh下载，其中pv命令是为了查看进度，换成cat其实也可以</span>
$ <span class="token function">ssh</span> work@192.168.0.1 <span class="token string">'cat /home/work/logs/app.log'</span> <span class="token operator">|</span> <span class="token function">pv</span> <span class="token operator">&gt;</span> ./logs/app.log

<span class="token comment"># 使用ssh上传，其中pv命令是为了查看进度，换成cat其实也可以</span>
$ <span class="token function">pv</span> ./logs/app.log <span class="token operator">|</span> <span class="token function">ssh</span> work@192.168.0.1 <span class="token string">'cat &gt; /home/work/logs/app.log'</span>

<span class="token comment"># 对比远程文件与本地文件内容</span>
$ <span class="token function">ssh</span> work@192.168.0.1 <span class="token string">'cat /path/to/remotefile'</span> <span class="token operator">|</span> icdiff /path/to/localfile –
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="sshfs挂载远程目录"><a href="#sshfs挂载远程目录" class="header-anchor">#</a> sshfs挂载远程目录</h3> <p>如果你觉得这样上传下载好麻烦，可以使用sshfs将远程主机上的目录，直接挂载到本机上，这样你就可以像访问本机文件一样访问远程文件了。</p> <p>sshfs是基于fuse机制与ssh协议实现的用户态文件系统，只要是你能用ssh的地方都能用sshfs，并且由于是用户态的文件系统，因此它并不像NFS那样需要特殊权限，只要网络连通即可，使用方法如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># sshfs挂载目录</span>
$ sshfs work@192.168.0.1:/home/work/logs /home/work/logs

<span class="token comment"># 列出文件</span>
$ <span class="token function">ls</span> /home/work/logs
app_2022-01-23T12:05:51.log  app_2022-01-23T12:05:53.log  app_2022-01-23T12:05:57.log  app_2022-01-23T12:06:00.log

<span class="token comment"># 使用ssh列出远程目录，与上面结果是一样的</span>
$ <span class="token function">ssh</span> work@192.168.0.1 <span class="token string">'ls /home/work/logs'</span>
app_2022-01-23T12:05:51.log
app_2022-01-23T12:05:53.log
app_2022-01-23T12:05:57.log
app_2022-01-23T12:06:00.log

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ls会检测输出对象是否是终端，如果是终端就会横排展示，否则竖排展示。</p> <p>其实好多命令都会有这种行为，比如<code>curl</code>默认不显示进度，但如果输出对象不是终端，如<code>curl|cat</code>，就会显示出进度信息。</p> <h3 id="免密码登录"><a href="#免密码登录" class="header-anchor">#</a> 免密码登录</h3> <p>一旦你这样用着ssh，就会发现每次都需要输入密码好麻烦，好在ssh提供了私钥认证机制，因此我们可以生成一对公私钥来避免每次都要输入密码，如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 使用ssh-keygen生成ssh密钥对，使用rsa算法，长度4096，生成的密钥默认~/.ssh目录下，私钥叫id_ras，公钥叫id_ras.pub</span>
ssh-keygen -o -t rsa -b <span class="token number">4096</span> -C <span class="token string">&quot;zhangsan@example.com&quot;</span>

<span class="token comment"># 使用ssh-copy-id将公钥上传到目标主机上</span>
ssh-copy-id -i ~/.ssh/id_rsa.pub work@192.168.0.1
<span class="token comment"># 没有ssh-copy-id时，这样上传公钥也是可以的</span>
<span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">|</span> <span class="token function">ssh</span> work@192.168.0.1 <span class="token string">'cat &gt;&gt; ~/.ssh/authorized_keys'</span>

<span class="token comment"># 测试公钥是否生效，如果看到Authentication succeeded (publickey).字样，说明成功</span>
<span class="token function">ssh</span> -vT work@192.168.0.1 <span class="token operator">&lt;</span>/dev/null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>其实<code>github</code>等也是一样使用ssh密钥来避免git操作需要输入密码的，配置过程是类似的：</p> <ol><li>使用ssh-kengen生成密钥对。</li> <li>将公钥手动拷贝到github的ssh密钥管理页面上并保存。</li> <li>测试配置成功。</li></ol> <h3 id="端口转发"><a href="#端口转发" class="header-anchor">#</a> 端口转发</h3> <p>有时，两个主机A、C之间网络并不互通，但A和B互通，B和C互通，这种情况下，我们可以利用B主机做一个端口转发，使得主机A可以访问主机C上的网络服务。</p> <p>能够实现端口转发的软件有很多，如iptables、socat、portmap、rinetd等，而ssh也是常见的一个，用法如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># ssh本地端口转发，在A机器上执行，会在A机开启2001端口，并将此端口数据发到B机，B机又转发到C机的80端口</span>
<span class="token function">ssh</span> -fgN -L2001:host_c:80 work@host_b
<span class="token comment"># ssh远端端口转发，在B机器上执行，在A机开启22333端口(由A机sshd服务打开)，将A机22333端口流量通过B机(中转机)转到C机的80端口上</span>
<span class="token function">ssh</span> -fgN -R <span class="token number">22333</span>:host_c:80 work@host_a

<span class="token comment"># ssh远端动态端口转发，在B机器上执行，会在A机开启2222端口开放socks代理服务，被代理的数据会发到B机，B机又转发到任何B机能访问的网络服务上</span>
<span class="token function">ssh</span> -fgN -R <span class="token number">2222</span> work@host_a
<span class="token comment"># ssh本地动态端口转发，在A机器上执行，会在A机开启2222端口开放socks代理服务，被代理的数据会发到B机，B机又转发到任何B机能访问的网络服务上</span>
<span class="token function">ssh</span> -Nfg -D <span class="token number">2222</span> work@host_b

<span class="token comment"># A机通过本机socks代理，登录到C机</span>
<span class="token function">ssh</span> -o <span class="token assign-left variable">ProxyCommand</span><span class="token operator">=</span><span class="token string">'ncat --proxy 127.0.0.1:2222 --proxy-type socks5 %h %p'</span> work@host_c
<span class="token comment"># A机通过B机ssh登录C机，其实就是两次ssh登录过程</span>
<span class="token function">ssh</span> -t work@host_b <span class="token string">'ssh work@host_c'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h1 id="read-键盘输入"><a href="#read-键盘输入" class="header-anchor">#</a> read 键盘输入</h1> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token builtin class-name">read</span> <span class="token punctuation">[</span>-p <span class="token string">&quot;提示信息&quot;</span><span class="token punctuation">]</span> 变量名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>-p</code>：提示信息。</p> <p><code>-t</code>：指定超时秒数。</p> <p><code>-s</code>：设置是否在终端显示输入的内容，设置则为不显示，默认显示。</p> <p><code>-a</code>：将分隔后的字段依次存储到 <code>-a</code> 指定的数组中，存储的起始位置从数组的 <code>index=0</code> 开始。</p> <p><code>-d</code>：指定读取行的结束符号，默认结束符号为换行符。</p> <p><code>-n</code>：限制输入 <code>n</code> 个字符就自动结束输入，如果没有输入满 <code>n</code> 个字符就按下回车或遇到换行符，则也会结束读取。</p> <p><code>-N</code>：限制输入 <code>N</code> 个字符就自动结束输入，如果没有输入满 <code>N</code> 个字符就按下回车或遇到结束符，不会结束 <code>read</code> 输入，此时的结束符算一个字符。</p> <p><code>-r</code>：禁止反斜线的转义功能，这意味着 <code>\</code> 会变成文本的一部分。</p> <p>上面配置项没有先后顺序，谁前谁后都行。</p> <p>举例</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 没有指定接受变量，直接输入名称，没有指定变量默认会存储到 $REPLY 全局属性中</span>
$ <span class="token builtin class-name">read</span>
$ <span class="token builtin class-name">echo</span> <span class="token environment constant">$REPLY</span>
<span class="token comment"># 指定接收变量，直接输入名称</span>
$ <span class="token builtin class-name">read</span> name
$ <span class="token builtin class-name">echo</span> <span class="token variable">$name</span>
<span class="token comment"># 使用 -p 有提示信息</span>
$ <span class="token builtin class-name">read</span> -p <span class="token string">&quot;请输入名称：&quot;</span> name
$ <span class="token builtin class-name">echo</span> <span class="token variable">$name</span>
<span class="token comment"># 使用 -s 有提示信息，输入不可见</span>
$ <span class="token builtin class-name">read</span> -s -p <span class="token string">&quot;请输入名称：&quot;</span> name
$ <span class="token builtin class-name">read</span> -p <span class="token string">&quot;请输入名称：&quot;</span> -s name
$ <span class="token builtin class-name">echo</span> <span class="token variable">$name</span>
<span class="token comment"># 使用 -t 必须在 3 秒内完成输入，否则 read 自动退出</span>
$ <span class="token builtin class-name">read</span> -t <span class="token number">3</span> name
$ <span class="token builtin class-name">echo</span> <span class="token variable">$name</span>
<span class="token comment"># 使用 -a 将输入的数据进行空格分隔成数组，并存储到 $arr</span>
$ <span class="token builtin class-name">read</span> -a arr
<span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span>
<span class="token comment"># 默认输出数组 0 位置</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">$arr</span>
<span class="token number">11</span>
<span class="token comment"># 输出全部</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">${arr<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
<span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">${arr<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>
<span class="token number">11</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">${arr<span class="token punctuation">[</span>1<span class="token punctuation">]</span>}</span>
<span class="token number">22</span>
<span class="token comment"># 使用 -d 设置 / 为结束符，而不是回车键位结束输入</span>
$ <span class="token builtin class-name">read</span> -d <span class="token string">'/'</span>
<span class="token number">123</span>
<span class="token number">123</span>
<span class="token number">123</span>/
$ <span class="token builtin class-name">echo</span> <span class="token environment constant">$REPLY</span>
<span class="token number">123</span> <span class="token number">123</span> <span class="token number">123</span>
<span class="token comment"># 使用 -n 设置输入长度为 5，输入到 5 位字符时自动结束输入</span>
$ <span class="token builtin class-name">read</span> -n <span class="token number">5</span>
<span class="token number">12345</span>
$ <span class="token builtin class-name">echo</span> <span class="token environment constant">$REPLY</span>
<span class="token number">12345</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h1 id="shell常用命令"><a href="#shell常用命令" class="header-anchor">#</a> shell常用命令</h1> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#result2=$(awk-F= '/'${key}'/{print $2}' ${base_path}/i18n_config.properties)</span>
<span class="token assign-left variable">message</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> $<span class="token punctuation">{</span>key<span class="token punctuation">}</span> $<span class="token punctuation">{</span>base_path<span class="token punctuation">}</span>/i18n_config.properties <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">'='</span> -f2<span class="token variable">)</span></span>
<span class="token comment">#字符串查找替换</span>
<span class="token function">sed</span> -i <span class="token string">'s=/usr/share/lcm/bin/lcm_script -q `whoami`=#/usr/share/lcm/bin/lcm_script -q `whoami`=g'</span> /root/.bashrc
<span class="token comment">#替换下一行</span>
<span class="token function">sed</span> -i <span class="token string">'/`whoami`/{n;s/exit/#exit/;}'</span> /root/.bashrc

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://gitee.com/vividcode/vuepress-blog/edit/master/docs/01.教程/02.其他/06.shell脚本.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/04/11, 20:59:37</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/vuepress-blog/pages/2a9112/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">PicGo图床搭建</div></a> <a href="/vuepress-blog/pages/2a9116/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">ansible</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vuepress-blog/pages/2a9112/" class="prev">PicGo图床搭建</a></span> <span class="next"><a href="/vuepress-blog/pages/2a9116/">ansible</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"></div></div>
    <script src="/vuepress-blog/assets/js/app.b4cdbde0.js" defer></script><script src="/vuepress-blog/assets/js/2.55043232.js" defer></script><script src="/vuepress-blog/assets/js/15.6453ad30.js" defer></script>
  </body>
</html>